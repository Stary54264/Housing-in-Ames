---
title: "Housing in Ames"
author: "Yanzun Jiang, Siyuan Lu, Yi Tang"
date: today
date-format: long
thanks: "Code and data supporting this proposal is available at: <https://github.com/Stary54264/Housing-in-Ames>"
format: pdf
number-sections: true
toc: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(knitr)
```

\newpage

# Introduction

Understanding the relationships between variables that influence house prices can provide deeper insights for various stakeholders, including homeowners, potential buyers, real estate agents, and policymakers, to make better decisions. Accurate prediction of house prices helps to make informed decisions about buying, selling and investing in real estate. In addition, it helps to assess the economic health of an area and plan for future developments.

The primary research question we aim to answer is: what are the key factors that significantly influence house prices in Ames from 2006 to 2010? Sale price of the house is the response variable. Predictor variables include lot size, overall quality, year of construction, roof style, masonry veneer area, total basement area, central air conditioning, garage size, and value of miscellaneous feature. The hypothesis we state is that there is a statistically significant linear relationship between certain property characteristics (predictors) and the sale price of houses (response). This hypothesis will be tested using linear regression, which would be appropriate in this case. We use residual plots and a Q-Q plot to check the assumption.

Linear regression provides coefficients that quantify the relationship between each predictor and the response variable, making it easier to interpret the impact of each factor on house prices. Specifically, it will provide estimates of how much the sale price is expected to change with a one-unit change in each predictor variable, holding other variables constant. Our primary goal is to understand the impact of each predictor on house prices, so the focus should be on interpretability instead of precision or accuracy.

We found several peer-reviewed articles that focus on similar problems with this paper. @influencing analyzed the influence factors for market supply and demand of commodity housing, and established price influence factors analysis model based on multiple linear regression. The article studies influencing factors of house price using the same method, linear regression, as we do, providing an example of setting a linear regression on factors and house price.

In @range, authors develop a novel fuzzy linear regression framework using symmetric and asymmetric trapezoidal fuzzy numbers for determining the relationship of particular (non-) policy factors with the house prices. The article shows the relationship between policy factors and house price, which demonstrates a different aspect of our research question.

In the real estate industry, the price of property plays a crucial role in economic growth. The research @MLT attempts to predict the price of a house using MLTs. Here, the price of the property is predicted using Extreme Gradient (XG) boosting algorithm and hedonic regression pricing. Both XGBoost and hedonic pricing models use 13 variables as inputs to predict house prices. The article uses an alternative regression method to study the relationship between multiple factors and house price.

In @sec-data, we introduce the source and overview of our dataset. Variables used in regression is explained in detail. Then, in @sec-ethics, we talk about the data ethics. Finally, in @sec-results, we address the result of the regression model, plots that verifies the assumptions, and descriptions.

# Data Description {#sec-data}

```{r}
#| include: false
#| warning: false
#| message: false

# Read data from cleaned data file
data <- read_csv(here::here("data", "cleaned_data.csv"))
```

```{r}
#| include: false
#| warning: false
#| message: false

# Separate the dataset into two parts for better visualization
data1 <- data |> select(
  sale_price, lot_area, overall_qual, year_built, roof_style
)

data2 <- data |> select(
  mas_vnr_area, total_bsmt_sf, central_air, garage_area, misc_val
)
```

```{r}
#| label: tbl-data-1
#| tbl-cap: Preview of Data (First Half)
#| echo: false
#| warning: false
#| message: false

# Visualize part of the dataset
kable(head(data1), format = "markdown")
```

```{r}
#| label: tbl-data-2
#| tbl-cap: Preview of Data (Second Half)
#| echo: false
#| warning: false
#| message: false

# Visualize part of the dataset
kable(head(data2), format = "markdown")
```

The Ames Housing dataset (@tbl-data-1, @tbl-data-2) was sourced from the `AmesHousing` package (@ameshousing) in R (@citeR). It was originally compiled by the Ames City Assessor's Office through a comprehensive data dump of property tax records from 2006 to 2010, and it aimed to document residential property sales (@ames). The dataset was initially designed for property tax assessments and general valuation, focusing on property characteristics such as lot area, the year built, and sale price. In contrast, this research aims to analyze how various property features influence house prices in Ames.

The dataset consists of 2930 observations and 82 variables relevant to understanding housing market dynamics. It was cleaned using `tidyverse` package (@tidyverse). After cleaning, we selected 1 response variable, `sale_price`, and 9 predictor variables: `lot_area`, `overall_qual`, `year_built`, `roof_style`, `mas_vnr_area`, `total_bsmt_sf`, `central_air`, `garage_area`, and `misc_val`.

- `sale_price`: Priceof the house in dollars

- `lot_area`: Lot size in square feet

- `overall_qual`: Rates the overall material and finish of the house

- `year_built`: Original construction date

- `roof_style`: Type of roof

- `mas_vnr_area`: Masonry veneer area in square feet

- `total_bsmt_sf`: Total square feet of basement area

- `central_air`: Central air conditioning

- `garage_area`: Size of garage in square feet

- `misc_val`: Value of miscellaneous feature in dollars

These predictor variables all shows the quality of the house, which will affect the price of the house directly. So, we believe there is a linear relationship between these predictor variables and the response variable.

```{r}
#| echo: false
#| warning: false
#| message: false

# Generate a dataset that only consists numerical data
data_numerical <- data |>
  select(sale_price, lot_area, overall_qual, year_built,
         mas_vnr_area, total_bsmt_sf, garage_area, misc_val
  )
```

```{r}
#| label: tbl-summary
#| tbl-cap: Summarize Table of Numerical Data
#| echo: false
#| warning: false
#| message: false

summary_table <- data.frame(
  Mean = round(apply(data_numerical, 2, mean), 2),
  Standard_Deviation = round(apply(data_numerical, 2, sd), 2),
  Median = round(apply(data_numerical, 2, median), 2)
)

kable(summary_table, format = "markdown")
```

From the summary table (@tbl-summary), we can easily see that `mas_vnr_area` and `misc_val` might be right-skewed since their mean is a lot greater than their median. An interesting point is that the standard deviation of `misc_val` is quite large, which indicate that houses in Ames might differs significantly in miscellaneous features. By analyzing these variables, we aim to provide insights into how specific property characteristics affect housing prices in Ames, Iowa.

# Ethics Discussion {#sec-ethics}

# Preliminary Results {#sec-results}

```{r}
#| echo: false
#| warning: false
#| message: false

# Convert variables to factors
data$central_air <- as.factor(data$central_air)
data$roof_style <- as.factor(data$roof_style)

# Fit the linear model
model <- lm(sale_price ~
              lot_area + overall_qual + year_built + roof_style +
              mas_vnr_area + total_bsmt_sf + central_air + garage_area +
              misc_val, data = data
)
```

```{r}
#| label: fig-resid
#| fig-cap: Uncorrelated errors testing
#| echo: false
#| warning: false
#| message: false

# value residuals

residuals <- resid(model)

# Create a data frame with residuals and observation order (index)
residuals_df <- data.frame(residuals = residuals, observation = 1:length(residuals))

# Plot residuals against observation index to check for uncorrelated errors
ggplot(residuals_df, aes(x = observation, y = residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, col = "red") +  # Add a horizontal line at 0
  xlab("Predictor") +
  ylab("Residuals") +
  ggtitle("Residuals vs. Predictor") +
  theme_minimal()
```

I plotted residuals against observation order to test uncorrelated errors. If errors are uncorrelated, residuals should scatter randomly around the horizontal axis without any clear pattern. From @fig-resid, we can see that residuals appear to be randomly distributed across observations, which satisfy the assumption of independence in the linear regression model. But there still have some larger residuals, we can regard these points as potential outliers.

```{r}
#| label: fig-constant-variance
#| fig-cap: Constant variance testing
#| echo: false
#| warning: false
#| message: false

fitted_values <- fitted(model)
residuals <- resid(model)

# Create a data frame with fitted values and residuals
residuals_df <- data.frame(fitted_values = fitted_values, residuals = residuals)

# Plot Residuals vs Fitted values to check for constant variance
ggplot(residuals_df, aes(x = fitted_values, y = residuals)) +
  geom_point() +
  geom_smooth(method = "loess", color = "red", se = FALSE) +
  geom_hline(yintercept = 0, color = "blue") +
  xlab("Fitted Values") +
  ylab("Residuals") +
  ggtitle("Residuals vs Fitted Values Plot") +
  theme_minimal()
```

The constant variance assumption means we assume that the variance of the marginal distribution of responses does not change with the value of the predictor. The red loess curve added to the plot highlights this trend, showing a wider spread of residuals as the fitted values rise. From @fig-constant-variance, all data points lead to a fanning effect which against the assumption of constant variance(also known as homoskedasticity). The red loess curve added to the plot highlights this trend, showing a wider spread of residuals as the fitted values rise.

For linearity, the residuals are scattered relatively randomly around the horizontal line at zero, without showing any distinct or systematic patterns, such as curves or trends. Based on the @fig-constant-variance plot, most of the residuals are centered around the horizontal line and no obvious non-linear patterns like U-shaped or inverted U-shaped trends in the plot, which satisfies the assumption of linearity, although there are a few outliers. This suggests that the relationship between the predictors (like lot_area, overall_qual, and year_built) and the response variable (sale price) is mostly linear.

```{r}
#| label: fig-qq
#| fig-cap: Q-Q Plot
#| echo: false
#| warning: false
#| message: false

# QQ plot
qqnorm(resid(model))
qqline(resid(model), col = "red")
```

In a well-behaved model that follows a normal distribution, the points in the Q-Q plot should align closely with the red reference line. Based on the @fig-qq, most of the residuals are near the red line, which suggests that the central part of the residual distribution generally follows a normal distribution. Although there are some deviations at the tails, these are unlikely to have a major impact on the model's overall performance. Therefore, the Q-Q plot indicates that the data mostly satisfies the normality assumption.

\newpage

\appendix

# Appendix

## Contributions {#sec-contribution}

Group contribution is available at <https://github.com/Stary54264/Housing-in-Ames/graphs/contributors>. Below is a more specific version of group contribution.

- Yanzun Jiang: Organized discussions and meetings; assigned tasks to group members; set up Github workspace for collaborating; downloaded data for setting up the linear regression model; cleaned data to make further analysis easier; completed @sec-data in the proposal; made the reference list; revised and combined group member's work together.

- Siyuan Lu: 

- Yi Tang: Built linear regression model to predict house sale prices by using five key predictors in cleaned data. It assisted to understand the relationship between variables and ensure data meets key assumptions for statistical validity.

\newpage

# References
